# yaml-language-server: $schema=../schemas/workflow.schema.json
kind: Direct

name: JiraLinkedPRsFetcher

description: "Extracts GitHub PR links from Jira data and fetches their details."

agent:
  name: JiraLinkedPRsFetcher
  description: "Fetches details for GitHub PRs linked to Jira issues."
  instructions: |
    You are a PR details fetcher. Your job is to find GitHub PR links in the Jira data
    and fetch their current status and recent activity.

    Step 1: Look for GitHub PR URLs in the input data. They look like:
    - https://github.com/owner/repo/pull/123
    - PR #123
    - References to pull requests in comments

    Step 2: For each PR number found, call fetch_pull_request to get its details.

    Step 3: Output a summary of all linked PRs including:
    - PR number and title
    - Current state (open/closed/merged)
    - Author
    - Files changed count

    IMPORTANT:
    - Only fetch PRs that are explicitly linked in the Jira data
    - Call fetch_pull_request ONCE per PR
    - If no PRs are linked, output "No linked PRs found"
    - After fetching, summarize and STOP

    Pass through all the original Jira data along with the PR details.
  model:
    kind: llm
  tools:
    - fetch_pull_request

output:
  type: text

